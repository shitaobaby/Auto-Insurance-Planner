<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>è½¦é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨</title>
<!-- æ ·å¼ä¼˜åŒ– -->
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f0f2f5;
    padding: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 20px;
  }
  #formContainer {
    max-width: 800px;
    margin: 0 auto 30px auto;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h2 {
    margin-top: 30px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 8px;
    font-size: 1.2em;
    color: #333;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  input[type="text"],
  input[type="number"],
  textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  .inline-group {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 5px;
  }
  .inline-group label {
    font-weight: normal;
  }
  button {
    margin-top: 20px;
    padding: 12px 20px;
    font-size: 1em;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-right: 15px;
    transition: background-color 0.3s;
  }
  #btnExcel {
    background-color: #28a745;
    color: #fff;
  }
  #btnExcel:hover {
    background-color: #218838;
  }
  #btnWord {
    background-color: #007bff;
    color: #fff;
  }
  #btnWord:hover {
    background-color: #0069d9;
  }
  #btnMarkdown {
    background-color: #ffc107;
    color: #333;
  }
  #btnMarkdown:hover {
    background-color: #e0a800;
  }
  #outputContainer {
    max-width: 800px;
    margin: 0 auto;
  }
  #markdownOutput {
    white-space: pre-wrap;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #ccc;
    margin-top: 30px;
  }
</style>
<!-- å¼•å…¥å¿…è¦åº“ -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/docx/dist/docx.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
</head>
<body>

<h1>ğŸš— è½¦é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨</h1>

<div id="formContainer">
  <form id="surveyForm">
    <!-- è½¦è¾†åŸºæœ¬ä¿¡æ¯ -->
    <h2>ğŸš— è½¦è¾†åŸºæœ¬ä¿¡æ¯</h2>
    <label>å“ç‰Œå‹å·ï¼š</label>
    <input type="text" name="carModel" placeholder="ä¾‹å¦‚ï¼šæ—¥äº§é€å®¢2017æ¬¾ 2.0L CVTæ™ºäº«ç‰ˆ" />

    <label>è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰ï¼š</label>
    <input type="number" name="purchasePrice" min="0" step="0.1" />

    <label>è½¦é¾„ï¼ˆå¹´ï¼‰ï¼š</label>
    <input type="number" name="carAge" min="0" />

    <label>å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰ï¼š</label>
    <input type="number" name="mileage" min="0" />

    <label>è½¦è¾†ç”¨é€”ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="usage" value="å®¶åº­è‡ªç”¨" checked />å®¶åº­è‡ªç”¨</label>
      <label><input type="radio" name="usage" value="å¶å°”å•†åŠ¡" />å¶å°”å•†åŠ¡</label>
      <label><input type="radio" name="usage" value="å…¶ä»–" />å…¶ä»–</label>
    </div>
    <input type="text" name="usageOther" placeholder="è¯·å¡«å†™å…¶ä»–ç”¨é€”" />

    <!-- ç”¨è½¦ç¯å¢ƒ -->
    <h2>ğŸ™ï¸ ç”¨è½¦ç¯å¢ƒ</h2>
    <label>ä¸»è¦è¡Œé©¶åŒºåŸŸï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="area" value="ä¸€çº¿åŸå¸‚" checked />ä¸€çº¿åŸå¸‚</label>
      <label><input type="radio" name="area" value="äºŒçº¿åŸå¸‚" />äºŒçº¿åŸå¸‚</label>
      <label><input type="radio" name="area" value="ä¸‰å››çº¿åŸå¸‚" />ä¸‰å››çº¿åŸå¸‚</label>
    </div>

    <label>å…·ä½“åŸå¸‚ï¼š</label>
    <input type="text" name="city" placeholder="ä¾‹å¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·" />

    <label>åœè½¦ç¯å¢ƒï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="parking" value="åœ°ä¸‹è½¦åº“" checked />åœ°ä¸‹è½¦åº“</label>
      <label><input type="radio" name="parking" value="éœ²å¤©åœè½¦åœº" />éœ²å¤©åœè½¦åœº</label>
      <label><input type="radio" name="parking" value="è·¯è¾¹åœè½¦" />è·¯è¾¹åœè½¦</label>
      <label><input type="radio" name="parking" value="å…¶ä»–" />å…¶ä»–</label>
    </div>
    <input type="text" name="parkingOther" placeholder="è¯·å¡«å†™å…¶ä»–åœè½¦ç¯å¢ƒ" />

    <label>è¡Œé©¶è·¯å†µï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="road" value="å¸‚åŒºä¸ºä¸»" checked />å¸‚åŒºä¸ºä¸»</label>
      <label><input type="radio" name="road" value="é«˜é€Ÿè¾ƒå¤š" />é«˜é€Ÿè¾ƒå¤š</label>
      <label><input type="radio" name="road" value="åŸä¹¡ç»“åˆ" />åŸä¹¡ç»“åˆ</label>
      <label><input type="radio" name="road" value="å±±åŒºé“è·¯" />å±±åŒºé“è·¯</label>
    </div>

    <!-- å®¶åº­ç”¨è½¦æƒ…å†µ -->
    <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­ç”¨è½¦æƒ…å†µ</h2>
    <label>ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰ï¼š</label>
    <input type="number" name="driverExperience" min="0" />

    <label>å¸¸è½½äººå‘˜ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="passengers" value="ä»…é©¾é©¶å‘˜" checked />ä»…é©¾é©¶å‘˜</label>
      <label><input type="radio" name="passengers" value="å¤«å¦»äºŒäºº" />å¤«å¦»äºŒäºº</label>
      <label><input type="radio" name="passengers" value="å¸¦å°å­©" />å¸¦å°å­©</label>
      <label><input type="radio" name="passengers" value="å¸¦è€äºº" />å¸¦è€äºº</label>
    </div>

    <label>é€šå¸¸è½½å®¢æ•°ï¼š</label>
    <input type="number" name="usualPassengers" min="0" />

    <label>æœ€å¤šè½½å®¢æ•°ï¼š</label>
    <input type="number" name="maxPassengers" min="0" />

    <label>å‡ºè¡Œé¢‘ç‡ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="frequency" value="æ¯å¤©" />æ¯å¤©</label>
      <label><input type="radio" name="frequency" value="å·¥ä½œæ—¥" />å·¥ä½œæ—¥</label>
      <label><input type="radio" name="frequency" value="å‘¨æœ«" />å‘¨æœ«</label>
      <label><input type="radio" name="frequency" value="å¶å°”" />å¶å°”</label>
    </div>

    <!-- é¢„ç®—ä¸é£é™©åå¥½ -->
    <h2>ğŸ’° é¢„ç®—ä¸é£é™©åå¥½</h2>
    <label>å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼Œä¸‹é™ï¼‰ï¼š</label>
    <input type="number" name="minBudget" min="0" />

    <label>å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼Œä¸Šé™ï¼‰ï¼š</label>
    <input type="number" name="maxBudget" min="0" />

    <label>é£é™©æ‰¿å—èƒ½åŠ›ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="risk" value="ä¿å®ˆå‹ï¼ˆå…¨é¢ä¿éšœï¼‰" />ä¿å®ˆå‹ï¼ˆå…¨é¢ä¿éšœï¼‰</label>
      <label><input type="radio" name="risk" value="å¹³è¡¡å‹ï¼ˆé‡ç‚¹ä¿éšœï¼‰" />å¹³è¡¡å‹ï¼ˆé‡ç‚¹ä¿éšœï¼‰</label>
      <label><input type="radio" name="risk" value="æ¿€è¿›å‹ï¼ˆåŸºç¡€ä¿éšœï¼‰" />æ¿€è¿›å‹ï¼ˆåŸºç¡€ä¿éšœï¼‰</label>
    </div>

    <label>è‡ªä»˜èƒ½åŠ›ï¼ˆå°é¢æŸå¤± 5000 å…ƒä»¥ä¸‹ï¼‰ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="selfPay" value="èƒ½æ¥å—è‡ªä»˜" />èƒ½æ¥å—è‡ªä»˜</label>
      <label><input type="radio" name="selfPay" value="å¸Œæœ›å…¨èµ”" />å¸Œæœ›å…¨èµ”</label>
    </div>

    <!-- ç‰¹æ®Šéœ€æ±‚ -->
    <h2>ğŸ¯ ç‰¹æ®Šéœ€æ±‚</h2>
    <label>æ˜¯å¦éœ€è¦ä»£æ­¥è½¦æœåŠ¡ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="ä»£æ­¥è½¦" value="éœ€è¦" />éœ€è¦</label>
      <label><input type="radio" name="ä»£æ­¥è½¦" value="ä¸éœ€è¦" />ä¸éœ€è¦</label>
    </div>

    <label>æ˜¯å¦ç»å¸¸è·‘é«˜é€Ÿï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="highway" value="æ˜¯" />æ˜¯</label>
      <input type="number" name="highwayTimes" placeholder="æœˆæ¬¡æ•°ä»¥ä¸Š" min="0" />
      <label><input type="radio" name="highway" value="å¦" />å¦</label>
    </div>

    <label>æ˜¯å¦æœ‰è¥è¿éœ€æ±‚ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="operation" value="ç½‘çº¦è½¦" />ç½‘çº¦è½¦</label>
      <label><input type="radio" name="operation" value="è´§è¿" />è´§è¿</label>
      <label><input type="radio" name="operation" value="çº¯å®¶ç”¨" />çº¯å®¶ç”¨</label>
    </div>

    <label>è¿‘ 3 å¹´å‡ºé™©æ¬¡æ•°ï¼š</label>
    <input type="number" name="accidentTimes" min="0" />

    <label>è¿‘ 3 å¹´æœ€å¤§èµ”ä»˜ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" name="maxCompensation" min="0" />

    <!-- å…³æ³¨é‡ç‚¹ -->
    <h2>ğŸ” å…³æ³¨é‡ç‚¹ï¼ˆå¯å¤šé€‰ï¼‰</h2>
    <div class="inline-group">
      <label><input type="checkbox" name="concern" value="ç¬¬ä¸‰æ–¹äººä¼¤é«˜é¢èµ”ä»˜ä¿éšœ" />ç¬¬ä¸‰æ–¹äººä¼¤é«˜é¢èµ”ä»˜ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="è‡ªè½¦ç»´ä¿®è´¹ç”¨ä¿éšœ" />è‡ªè½¦ç»´ä¿®è´¹ç”¨ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="è½¦å†…äººå‘˜å®‰å…¨ä¿éšœ" />è½¦å†…äººå‘˜å®‰å…¨ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="ç›—æŠ¢/è‡ªç„¶ç¾å®³ä¿éšœ" />ç›—æŠ¢/è‡ªç„¶ç¾å®³ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="é™ä½ä¿è´¹æˆæœ¬" />é™ä½ä¿è´¹æˆæœ¬</label>
      <label><input type="checkbox" name="concern" value="å¢å€¼æœåŠ¡ï¼ˆé“è·¯æ•‘æ´ç­‰ï¼‰" />å¢å€¼æœåŠ¡ï¼ˆé“è·¯æ•‘æ´ç­‰ï¼‰</label>
    </div>

    <!-- å…¶ä»–è¡¥å……ä¿¡æ¯ -->
    <h2>ğŸ“ å…¶ä»–è¡¥å……ä¿¡æ¯</h2>
    <label>ç‰¹æ®Šæƒ…å†µè¯´æ˜ï¼š</label>
    <textarea name="specialSituation" rows="3" placeholder="è¡¥å……ç‰¹æ®Šæƒ…å†µæˆ–éœ€æ±‚"></textarea>

    <label>æœ€å…³å¿ƒçš„ä¿é™©é—®é¢˜ï¼š</label>
    <textarea name="concernedQuestion" rows="3" placeholder="è¯·å¡«å†™æ‚¨æœ€å…³å¿ƒçš„é—®é¢˜"></textarea>
  </form>
</div>

<!-- æŒ‰é’®åŒºåŸŸ -->
<div style="text-align:center;">
  <button id="btnExcel" onclick="exportExcel()">å¯¼å‡ºä¸ºExcel</button>
  <button id="btnMarkdown" onclick="exportMarkdown()">å¯¼å‡ºä¸ºMarkdown</button>
</div>

<script>
  // è·å–è¡¨å•æ•°æ®
function getFormData() {
  const form = document.getElementById('surveyForm');
  const data = {};
  new FormData(form).forEach((value, key) => {
    if (data[key]) {
      // å¤šé€‰
      if (Array.isArray(data[key])) {
        data[key].push(value);
      } else {
        data[key] = [data[key], value];
      }
    } else {
      data[key] = value;
    }
  });
  return data;
}

// å¯¼å‡ºExcel
function exportExcel() {
  const data = getFormData();
  const sheetData = [
    ['å­—æ®µ', 'å†…å®¹'],
    ['è½¦å‹', data.carModel || ''],
    ['è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰', data.purchasePrice || ''],
    ['è½¦é¾„ï¼ˆå¹´ï¼‰', data.carAge || ''],
    ['å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰', data.mileage || ''],
    ['è½¦è¾†ç”¨é€”', data.usage || ''],
    ['å…¶ä»–ç”¨é€”', data.usageOther || ''],
    ['ä¸»è¦è¡Œé©¶åŒºåŸŸ', data.area || ''],
    ['å…·ä½“åŸå¸‚', data.city || ''],
    ['åœè½¦ç¯å¢ƒ', data.parking || ''],
    ['å…¶ä»–åœè½¦ç¯å¢ƒ', data.parkingOther || ''],
    ['è¡Œé©¶è·¯å†µ', data.road || ''],
    ['ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰', data.driverExperience || ''],
    ['å¸¸è½½äººå‘˜', data.passengers || ''],
    ['é€šå¸¸è½½å®¢æ•°', data.usualPassengers || ''],
    ['æœ€å¤šè½½å®¢æ•°', data.maxPassengers || ''],
    ['å‡ºè¡Œé¢‘ç‡', data.frequency || ''],
    ['å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼‰', data.minBudget || ''],
    ['å¹´ä¿è´¹ä¸Šé™ï¼ˆå…ƒï¼‰', data.maxBudget || ''],
    ['é£é™©æ‰¿å—èƒ½åŠ›', data.risk || ''],
    ['è‡ªä»˜èƒ½åŠ›', data.selfPay || ''],
    ['æ˜¯å¦éœ€è¦ä»£æ­¥è½¦', data.ä»£æ­¥è½¦ || ''],
    ['æ˜¯å¦ç»å¸¸è·‘é«˜é€Ÿ', data.highway || ''],
    ['é«˜é€Ÿæœˆæ¬¡æ•°', data.highwayTimes || ''],
    ['è¥è¿éœ€æ±‚', data.operation || ''],
    ['å‡ºé™©æ¬¡æ•°ï¼ˆè¿‘3å¹´ï¼‰', data.accidentTimes || ''],
    ['æœ€å¤§èµ”ä»˜ï¼ˆå…ƒï¼‰', data.maxCompensation || ''],
    ['å…³æ³¨é‡ç‚¹', (data.concern || []).join('ã€')],
    ['ç‰¹æ®Šæƒ…å†µè¯´æ˜', data.specialSituation || ''],
    ['æœ€å…³å¿ƒçš„é—®é¢˜', data.concernedQuestion || '']
  ];

  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(sheetData);
  XLSX.utils.book_append_sheet(wb, ws, 'è°ƒç ”æ•°æ®');
  XLSX.writeFile(wb, 'è½¦é™©è°ƒç ”æ•°æ®.xlsx');
}

// å¯¼å‡ºMarkdown
function exportMarkdown() {
  const data = getFormData();
  // å­—æ®µä¸æ ‡é¢˜
  const fields = [
    ['è½¦å‹', data.carModel || ''],
    ['è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰', data.purchasePrice || ''],
    ['è½¦é¾„ï¼ˆå¹´ï¼‰', data.carAge || ''],
    ['å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰', data.mileage || ''],
    ['è½¦è¾†ç”¨é€”', data.usage || ''],
    ['å…¶ä»–ç”¨é€”', data.usageOther || ''],
    ['ä¸»è¦è¡Œé©¶åŒºåŸŸ', data.area || ''],
    ['å…·ä½“åŸå¸‚', data.city || ''],
    ['åœè½¦ç¯å¢ƒ', data.parking || ''],
    ['å…¶ä»–åœè½¦ç¯å¢ƒ', data.parkingOther || ''],
    ['è¡Œé©¶è·¯å†µ', data.road || ''],
    ['ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰', data.driverExperience || ''],
    ['å¸¸è½½äººå‘˜', data.passengers || ''],
    ['é€šå¸¸è½½å®¢æ•°', data.usualPassengers || ''],
    ['æœ€å¤šè½½å®¢æ•°', data.maxPassengers || ''],
    ['å‡ºè¡Œé¢‘ç‡', data.frequency || ''],
    ['å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼Œä¸‹é™ï¼‰', data.minBudget || ''],
    ['å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼Œä¸Šé™ï¼‰', data.maxBudget || ''],
    ['é£é™©æ‰¿å—èƒ½åŠ›', data.risk || ''],
    ['è‡ªä»˜èƒ½åŠ›', data.selfPay || ''],
    ['æ˜¯å¦éœ€è¦ä»£æ­¥è½¦', data.ä»£æ­¥è½¦ || ''],
    ['æ˜¯å¦ç»å¸¸è·‘é«˜é€Ÿ', data.highway || ''],
    ['é«˜é€Ÿæœˆæ¬¡æ•°', data.highwayTimes || ''],
    ['è¥è¿éœ€æ±‚', data.operation || ''],
    ['å‡ºé™©æ¬¡æ•°ï¼ˆè¿‘3å¹´ï¼‰', data.accidentTimes || ''],
    ['æœ€å¤§èµ”ä»˜ï¼ˆå…ƒï¼‰', data.maxCompensation || ''],
    ['å…³æ³¨é‡ç‚¹', (data.concern || []).join('ã€')],
    ['ç‰¹æ®Šæƒ…å†µè¯´æ˜', data.specialSituation || ''],
    ['æœ€å…³å¿ƒçš„é—®é¢˜', data.concernedQuestion || '']
  ];

  let md = `# è½¦é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨\n\n`;
  md += `| å­—æ®µ | å†…å®¹ |\n| --- | --- |\n`;
  fields.forEach(([k, v]) => {
    // è½¬ä¹‰ç«–çº¿
    v = (v + '').replace(/\|/g, '\\|');
    md += `| ${k} | ${v} |\n`;
  });

  // ä¸‹è½½
  const blob = new Blob([md], {type: 'text/markdown'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'è½¦é™©è°ƒç ”æ•°æ®.md';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// ç»‘å®šæŒ‰é’®äº‹ä»¶
document.getElementById('btnExcel').onclick = exportExcel;
document.getElementById('btnMarkdown').onclick = exportMarkdown;
</script>

</body>
</html>
