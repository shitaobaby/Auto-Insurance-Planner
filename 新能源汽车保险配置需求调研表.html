<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>æ–°èƒ½æºæ±½è½¦ä¿é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: #f4f5f7;
    padding: 20px;
    color: #333;
  }
  h1, h2 {
    text-align: center;
  }
  h1 {
    color: #1a1a1a;
    margin-bottom: 20px;
  }
  #formContainer {
    max-width: 800px;
    margin: 0 auto 30px auto;
    background: #fff;
    padding: 25px 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }
  h2 {
    margin-top: 30px;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
    font-size: 1.3em;
    color: #007bff;
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 18px;
    font-weight: bold;
    font-size: 1.05em;
  }
  input[type="text"],
  input[type="number"],
  textarea {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 6px;
    transition: border-color 0.3s;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  textarea:focus {
    border-color: #007bff;
    outline: none;
  }
  .inline-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 20px;
    margin-top: 10px;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 6px;
  }
  .inline-group label {
    font-weight: normal;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  input[type="radio"], input[type="checkbox"] {
      transform: scale(1.1);
  }
  button {
    margin-top: 20px;
    padding: 12px 25px;
    font-size: 1.1em;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-right: 15px;
    transition: all 0.3s;
    font-weight: bold;
  }
  #btnExcel {
    background-color: #28a745;
    color: #fff;
  }
  #btnExcel:hover {
    background-color: #218838;
    transform: translateY(-2px);
  }
  #btnMarkdown {
    background-color: #6c757d;
    color: #fff;
  }
  #btnMarkdown:hover {
    background-color: #5a6268;
    transform: translateY(-2px);
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
</head>
<body>

<h1>âš¡ æ–°èƒ½æºæ±½è½¦ä¿é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨</h1>

<div id="formContainer">
  <form id="surveyForm">
    <h2>ğŸš— è½¦è¾†åŸºæœ¬ä¿¡æ¯</h2>
    <label>å“ç‰Œå‹å·ï¼š</label>
    <input type="text" name="carModel" placeholder="ä¾‹å¦‚ï¼šç‰¹æ–¯æ‹‰ Model Y 2024æ¬¾ åè½®é©±åŠ¨ç‰ˆ" />

    <label>è½¦è¾†ç±»å‹ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="carType" value="çº¯ç”µåŠ¨(BEV)" checked />çº¯ç”µåŠ¨(BEV)</label>
      <label><input type="radio" name="carType" value="æ’ç”µæ··åŠ¨(PHEV)" />æ’ç”µæ··åŠ¨(PHEV)</label>
      <label><input type="radio" name="carType" value="å¢ç¨‹å¼(EREV)" />å¢ç¨‹å¼(EREV)</label>
    </div>

    <label>è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰ï¼š</label>
    <input type="number" name="purchasePrice" min="0" step="0.1" />

    <label>è½¦é¾„ï¼ˆå¹´ï¼‰ï¼š</label>
    <input type="number" name="carAge" min="0" />

    <label>å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰ï¼š</label>
    <input type="number" name="mileage" min="0" />

    <h2>ğŸ”Œ å……ç”µä¸ç”µæ± ä¿¡æ¯</h2>
    <label>æ˜¯å¦æœ‰å›ºå®šè‡ªç”¨å……ç”µæ¡©ï¼š</label>
    <div class="inline-group">
        <label><input type="radio" name="chargingPile" value="æœ‰" checked/>æœ‰</label>
        <label><input type="radio" name="chargingPile" value="æ— "/>æ— </label>
    </div>

    <label>å……ç”µæ¡©å®‰è£…ä½ç½®ï¼š</label>
    <div class="inline-group">
        <label><input type="radio" name="pileLocation" value="ç§äººåœ°åº“è½¦ä½" checked/>ç§äººåœ°åº“è½¦ä½</label>
        <label><input type="radio" name="pileLocation" value="éœ²å¤©ç§äººè½¦ä½"/>éœ²å¤©ç§äººè½¦ä½</label>
        <label><input type="radio" name="pileLocation" value="å°åŒºå…¬å…±è½¦ä½"/>å°åŒºå…¬å…±è½¦ä½</label>
        <label><input type="radio" name="pileLocation" value="ä¸é€‚ç”¨"/>ä¸é€‚ç”¨</label>
    </div>
    
    <label>æ˜¯å¦ç»å¸¸ä½¿ç”¨å…¬å…±å……ç”µæ¡©ï¼š</label>
    <div class="inline-group">
        <label><input type="radio" name="publicCharging" value="æ˜¯" />æ˜¯</label>
        <label><input type="radio" name="publicCharging" value="å¦" checked />å¦</label>
    </div>


    <h2>ğŸ™ï¸ ç”¨è½¦ç¯å¢ƒ</h2>
    <label>ä¸»è¦è¡Œé©¶åŒºåŸŸï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="area" value="ä¸€çº¿åŸå¸‚" checked />ä¸€çº¿åŸå¸‚</label>
      <label><input type="radio" name="area" value="æ–°ä¸€çº¿/äºŒçº¿åŸå¸‚" />æ–°ä¸€çº¿/äºŒçº¿åŸå¸‚</label>
      <label><input type="radio" name="area" value="ä¸‰å››çº¿åŠä»¥ä¸‹åŸå¸‚" />ä¸‰å››çº¿åŠä»¥ä¸‹åŸå¸‚</label>
    </div>

    <label>åœè½¦ç¯å¢ƒï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="parking" value="å›ºå®šåœ°åº“" checked />å›ºå®šåœ°åº“</label>
      <label><input type="radio" name="parking" value="éœ²å¤©åœè½¦åœº" />éœ²å¤©åœè½¦åœº</label>
      <label><input type="radio" name="parking" value="è·¯è¾¹" />è·¯è¾¹</label>
    </div>

    <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­ç”¨è½¦æƒ…å†µ</h2>
    <label>ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰ï¼š</label>
    <input type="number" name="driverExperience" min="0" />

    <label>å¸¸è½½äººå‘˜ï¼š</label>
    <div class="inline-group">
      <label><input type="checkbox" name="passengers" value="ä»…é©¾é©¶å‘˜" />ä»…é©¾é©¶å‘˜</label>
      <label><input type="checkbox" name="passengers" value="é…å¶/ä¼´ä¾£" />é…å¶/ä¼´ä¾£</label>
      <label><input type="checkbox" name="passengers" value="å„¿ç«¥" />å„¿ç«¥</label>
      <label><input type="checkbox" name="passengers" value="è€äºº" />è€äºº</label>
    </div>

    <h2>ğŸ’° é¢„ç®—ä¸é£é™©åå¥½</h2>
    <label>å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼‰ï¼š</label>
    <div style="display: flex; gap: 10px;">
        <input type="number" name="minBudget" min="0" placeholder="é¢„ç®—ä¸‹é™" />
        <input type="number" name="maxBudget" min="0" placeholder="é¢„ç®—ä¸Šé™" />
    </div>

    <label>é£é™©æ‰¿å—èƒ½åŠ›ï¼š</label>
    <div class="inline-group">
      <label><input type="radio" name="risk" value="ä¿å®ˆå‹ï¼ˆè¿½æ±‚å…¨é¢ä¿éšœï¼Œä¸æ€•ä¿è´¹é«˜ï¼‰" />ä¿å®ˆå‹ï¼ˆè¿½æ±‚å…¨é¢ä¿éšœï¼Œä¸æ€•ä¿è´¹é«˜ï¼‰</label>
      <label><input type="radio" name="risk" value="å¹³è¡¡å‹ï¼ˆä¿éšœæ ¸å¿ƒé£é™©ï¼Œå…¼é¡¾æ€§ä»·æ¯”ï¼‰" checked/>å¹³è¡¡å‹ï¼ˆä¿éšœæ ¸å¿ƒé£é™©ï¼Œå…¼é¡¾æ€§ä»·æ¯”ï¼‰</label>
      <label><input type="radio" name="risk" value="ç»æµå‹ï¼ˆä»…éœ€åŸºç¡€ä¿éšœï¼Œä¿è´¹ä¼˜å…ˆï¼‰" />ç»æµå‹ï¼ˆä»…éœ€åŸºç¡€ä¿éšœï¼Œä¿è´¹ä¼˜å…ˆï¼‰</label>
    </div>
    
    <h2>ğŸ” å…³æ³¨é‡ç‚¹ï¼ˆå¯å¤šé€‰ï¼‰</h2>
    <div class="inline-group">
      <label><input type="checkbox" name="concern" value="ç¬¬ä¸‰æ–¹äººä¼¤é«˜é¢èµ”ä»˜ä¿éšœ" />ç¬¬ä¸‰æ–¹äººä¼¤é«˜é¢èµ”ä»˜ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="ä¸‰ç”µç³»ç»Ÿï¼ˆç”µæ± ã€ç”µæœºã€ç”µæ§ï¼‰æ ¸å¿ƒä¿éšœ" />ä¸‰ç”µç³»ç»Ÿï¼ˆç”µæ± ã€ç”µæœºã€ç”µæ§ï¼‰æ ¸å¿ƒä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="è½¦å†…äººå‘˜å®‰å…¨ä¿éšœ" />è½¦å†…äººå‘˜å®‰å…¨ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="å……ç”µæ¡©åŠå……ç”µè¿‡ç¨‹å®‰å…¨ä¿éšœ" />å……ç”µæ¡©åŠå……ç”µè¿‡ç¨‹å®‰å…¨ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="å¤–éƒ¨ç”µç½‘æ•…éšœç­‰ç‰¹æ®Šé£é™©ä¿éšœ" />å¤–éƒ¨ç”µç½‘æ•…éšœç­‰ç‰¹æ®Šé£é™©ä¿éšœ</label>
      <label><input type="checkbox" name="concern" value="è½¦èº«åˆ’ç—•ã€è½¦è½®å•ç‹¬æŸåç­‰å°é¢æŸå¤±" />è½¦èº«åˆ’ç—•ã€è½¦è½®å•ç‹¬æŸåç­‰å°é¢æŸå¤±</label>
      <label><input type="checkbox" name="concern" value="å¢å€¼æœåŠ¡ï¼ˆé“è·¯æ•‘æ´ã€ä»£é©¾ç­‰ï¼‰" />å¢å€¼æœåŠ¡ï¼ˆé“è·¯æ•‘æ´ã€ä»£é©¾ç­‰ï¼‰</label>
      <label><input type="checkbox" name="concern" value="å°½å¯èƒ½é™ä½ä¿è´¹æˆæœ¬" />å°½å¯èƒ½é™ä½ä¿è´¹æˆæœ¬</label>
    </div>

    <h2>ğŸ“ å…¶ä»–è¡¥å……ä¿¡æ¯</h2>
    <label>è¿‘3å¹´å‡ºé™©æ¬¡æ•°ï¼š</label>
    <input type="number" name="accidentTimes" min="0" />

    <label>å…¶ä»–ç‰¹æ®Šæƒ…å†µæˆ–éœ€æ±‚è¯´æ˜ï¼š</label>
    <textarea name="specialSituation" rows="3" placeholder="ä¾‹å¦‚ï¼šè½¦è¾†æœ‰æ”¹è£…ã€ç»å¸¸é•¿é€”è‡ªé©¾ã€æœ‰ç‰¹å®šèŠ‚å‡æ—¥å‡ºè¡Œéœ€æ±‚ç­‰"></textarea>
  </form>
</div>

<div style="text-align:center;">
  <button id="btnExcel">å¯¼å‡ºä¸ºExcel</button>
  <button id="btnMarkdown">å¯¼å‡ºä¸ºMarkdown</button>
</div>

<script>
// è·å–è¡¨å•æ•°æ®
function getFormData() {
  const form = document.getElementById('surveyForm');
  const data = {};
  new FormData(form).forEach((value, key) => {
    const el = form.querySelector(`[name="${key}"]`);
    if (el && el.type === 'checkbox') {
        if (!data[key]) {
            data[key] = [];
        }
        data[key].push(value);
    } else {
        data[key] = value;
    }
  });
  return data;
}


// å¯¼å‡ºExcel
function exportExcel() {
  const data = getFormData();
  const sheetData = [
    ['é¡¹ç›®', 'å®¢æˆ·é€‰æ‹©'],
    ['--- è½¦è¾†åŸºæœ¬ä¿¡æ¯ ---', ''],
    ['å“ç‰Œå‹å·', data.carModel || ''],
    ['è½¦è¾†ç±»å‹', data.carType || ''],
    ['è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰', data.purchasePrice || ''],
    ['è½¦é¾„ï¼ˆå¹´ï¼‰', data.carAge || ''],
    ['å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰', data.mileage || ''],
    ['--- å……ç”µä¸ç”µæ± ä¿¡æ¯ ---', ''],
    ['æ˜¯å¦æœ‰å›ºå®šè‡ªç”¨å……ç”µæ¡©', data.chargingPile || ''],
    ['å……ç”µæ¡©å®‰è£…ä½ç½®', data.pileLocation || ''],
    ['æ˜¯å¦ç»å¸¸ä½¿ç”¨å…¬å…±å……ç”µæ¡©', data.publicCharging || ''],
    ['--- ç”¨è½¦ç¯å¢ƒ ---', ''],
    ['ä¸»è¦è¡Œé©¶åŒºåŸŸ', data.area || ''],
    ['åœè½¦ç¯å¢ƒ', data.parking || ''],
    ['--- å®¶åº­ç”¨è½¦æƒ…å†µ ---', ''],
    ['ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰', data.driverExperience || ''],
    ['å¸¸è½½äººå‘˜', (data.passengers || []).join('ã€')],
    ['--- é¢„ç®—ä¸é£é™©åå¥½ ---', ''],
    ['å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼‰', `ä¸‹é™: ${data.minBudget || 'æœªå¡«'}ï¼Œä¸Šé™: ${data.maxBudget || 'æœªå¡«'}`],
    ['é£é™©æ‰¿å—èƒ½åŠ›', data.risk || ''],
    ['--- å…³æ³¨é‡ç‚¹ ---', ''],
    ['å…³æ³¨ç‚¹', (data.concern || []).join('ã€')],
    ['--- å…¶ä»–è¡¥å……ä¿¡æ¯ ---', ''],
    ['è¿‘3å¹´å‡ºé™©æ¬¡æ•°', data.accidentTimes || ''],
    ['ç‰¹æ®Šæƒ…å†µè¯´æ˜', data.specialSituation || ''],
  ];

  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(sheetData);
  
  // è®¾ç½®åˆ—å®½
  ws['!cols'] = [{ wch: 25 }, { wch: 60 }];

  XLSX.utils.book_append_sheet(wb, ws, 'æ–°èƒ½æºè½¦é™©è°ƒç ”æ•°æ®');
  XLSX.writeFile(wb, 'æ–°èƒ½æºè½¦é™©è°ƒç ”æ•°æ®.xlsx');
}

// å¯¼å‡ºMarkdown
function exportMarkdown() {
  const data = getFormData();
  const fields = [
    ['**è½¦è¾†åŸºæœ¬ä¿¡æ¯**', ''],
    ['å“ç‰Œå‹å·', data.carModel || ''],
    ['è½¦è¾†ç±»å‹', data.carType || ''],
    ['è´­è½¦ä»·æ ¼ï¼ˆä¸‡å…ƒï¼‰', data.purchasePrice || ''],
    ['è½¦é¾„ï¼ˆå¹´ï¼‰', data.carAge || ''],
    ['å¹´è¡Œé©¶é‡Œç¨‹ï¼ˆå…¬é‡Œï¼‰', data.mileage || ''],
    ['**å……ç”µä¸ç”µæ± ä¿¡æ¯**', ''],
    ['æ˜¯å¦æœ‰å›ºå®šè‡ªç”¨å……ç”µæ¡©', data.chargingPile || ''],
    ['å……ç”µæ¡©å®‰è£…ä½ç½®', data.pileLocation || ''],
    ['æ˜¯å¦ç»å¸¸ä½¿ç”¨å…¬å…±å……ç”µæ¡©', data.publicCharging || ''],
    ['**ç”¨è½¦ç¯å¢ƒ**', ''],
    ['ä¸»è¦è¡Œé©¶åŒºåŸŸ', data.area || ''],
    ['åœè½¦ç¯å¢ƒ', data.parking || ''],
    ['**å®¶åº­ç”¨è½¦æƒ…å†µ**', ''],
    ['ä¸»è¦é©¾é©¶äººé©¾é¾„ï¼ˆå¹´ï¼‰', data.driverExperience || ''],
    ['å¸¸è½½äººå‘˜', (data.passengers || []).join('ã€')],
    ['**é¢„ç®—ä¸é£é™©åå¥½**', ''],
    ['å¹´ä¿è´¹é¢„ç®—ï¼ˆå…ƒï¼‰', `ä¸‹é™: ${data.minBudget || 'æœªå¡«'}ï¼Œä¸Šé™: ${data.maxBudget || 'æœªå¡«'}`],
    ['é£é™©æ‰¿å—èƒ½åŠ›', data.risk || ''],
    ['**å…³æ³¨é‡ç‚¹**', ''],
    ['å…³æ³¨ç‚¹', (data.concern || []).join('ã€')],
    ['**å…¶ä»–è¡¥å……ä¿¡æ¯**', ''],
    ['è¿‘3å¹´å‡ºé™©æ¬¡æ•°', data.accidentTimes || ''],
    ['ç‰¹æ®Šæƒ…å†µè¯´æ˜', data.specialSituation || '']
  ];

  let md = `# âš¡ æ–°èƒ½æºæ±½è½¦ä¿é™©é…ç½®éœ€æ±‚è°ƒç ”è¡¨\n\n`;
  md += `| å­—æ®µ | å†…å®¹ |\n| :--- | :--- |\n`;
  fields.forEach(([k, v]) => {
    v = (v + '').replace(/\|/g, '\\|').replace(/\n/g, '<br>');
    md += `| ${k} | ${v || 'æœªå¡«å†™'} |\n`;
  });

  const blob = new Blob([md], {type: 'text/markdown;charset=utf-8'});
  saveAs(blob, 'æ–°èƒ½æºè½¦é™©è°ƒç ”æ•°æ®.md');
}


// ç»‘å®šæŒ‰é’®äº‹ä»¶
document.getElementById('btnExcel').onclick = (e) => {
    e.preventDefault();
    exportExcel();
};
document.getElementById('btnMarkdown').onclick = (e) => {
    e.preventDefault();
    exportMarkdown();
};
</script>

</body>
</html>