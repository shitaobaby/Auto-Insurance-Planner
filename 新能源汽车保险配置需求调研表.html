<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>新能源汽车保险配置需求调研表</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: #f4f5f7;
    padding: 20px;
    color: #333;
  }
  h1, h2 {
    text-align: center;
  }
  h1 {
    color: #1a1a1a;
    margin-bottom: 20px;
  }
  #formContainer {
    max-width: 800px;
    margin: 0 auto 30px auto;
    background: #fff;
    padding: 25px 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }
  h2 {
    margin-top: 30px;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
    font-size: 1.3em;
    color: #007bff;
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 18px;
    font-weight: bold;
    font-size: 1.05em;
  }
  input[type="text"],
  input[type="number"],
  textarea {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 6px;
    transition: border-color 0.3s;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  textarea:focus {
    border-color: #007bff;
    outline: none;
  }
  .inline-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 20px;
    margin-top: 10px;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 6px;
  }
  .inline-group label {
    font-weight: normal;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  input[type="radio"], input[type="checkbox"] {
      transform: scale(1.1);
  }
  button {
    margin-top: 20px;
    padding: 12px 25px;
    font-size: 1.1em;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-right: 15px;
    transition: all 0.3s;
    font-weight: bold;
  }
  #btnExcel {
    background-color: #28a745;
    color: #fff;
  }
  #btnExcel:hover {
    background-color: #218838;
    transform: translateY(-2px);
  }
  #btnMarkdown {
    background-color: #6c757d;
    color: #fff;
  }
  #btnMarkdown:hover {
    background-color: #5a6268;
    transform: translateY(-2px);
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
</head>
<body>

<h1>⚡ 新能源汽车保险配置需求调研表</h1>

<div id="formContainer">
  <form id="surveyForm">
    <h2>🚗 车辆基本信息</h2>
    <label>品牌型号：</label>
    <input type="text" name="carModel" placeholder="例如：特斯拉 Model Y 2024款 后轮驱动版" />

    <label>车辆类型：</label>
    <div class="inline-group">
      <label><input type="radio" name="carType" value="纯电动(BEV)" checked />纯电动(BEV)</label>
      <label><input type="radio" name="carType" value="插电混动(PHEV)" />插电混动(PHEV)</label>
      <label><input type="radio" name="carType" value="增程式(EREV)" />增程式(EREV)</label>
    </div>

    <label>购车价格（万元）：</label>
    <input type="number" name="purchasePrice" min="0" step="0.1" />

    <label>车龄（年）：</label>
    <input type="number" name="carAge" min="0" />

    <label>年行驶里程（公里）：</label>
    <input type="number" name="mileage" min="0" />

    <h2>🔌 充电与电池信息</h2>
    <label>是否有固定自用充电桩：</label>
    <div class="inline-group">
        <label><input type="radio" name="chargingPile" value="有" checked/>有</label>
        <label><input type="radio" name="chargingPile" value="无"/>无</label>
    </div>

    <label>充电桩安装位置：</label>
    <div class="inline-group">
        <label><input type="radio" name="pileLocation" value="私人地库车位" checked/>私人地库车位</label>
        <label><input type="radio" name="pileLocation" value="露天私人车位"/>露天私人车位</label>
        <label><input type="radio" name="pileLocation" value="小区公共车位"/>小区公共车位</label>
        <label><input type="radio" name="pileLocation" value="不适用"/>不适用</label>
    </div>
    
    <label>是否经常使用公共充电桩：</label>
    <div class="inline-group">
        <label><input type="radio" name="publicCharging" value="是" />是</label>
        <label><input type="radio" name="publicCharging" value="否" checked />否</label>
    </div>


    <h2>🏙️ 用车环境</h2>
    <label>主要行驶区域：</label>
    <div class="inline-group">
      <label><input type="radio" name="area" value="一线城市" checked />一线城市</label>
      <label><input type="radio" name="area" value="新一线/二线城市" />新一线/二线城市</label>
      <label><input type="radio" name="area" value="三四线及以下城市" />三四线及以下城市</label>
    </div>

    <label>停车环境：</label>
    <div class="inline-group">
      <label><input type="radio" name="parking" value="固定地库" checked />固定地库</label>
      <label><input type="radio" name="parking" value="露天停车场" />露天停车场</label>
      <label><input type="radio" name="parking" value="路边" />路边</label>
    </div>

    <h2>👨‍👩‍👧‍👦 家庭用车情况</h2>
    <label>主要驾驶人驾龄（年）：</label>
    <input type="number" name="driverExperience" min="0" />

    <label>常载人员：</label>
    <div class="inline-group">
      <label><input type="checkbox" name="passengers" value="仅驾驶员" />仅驾驶员</label>
      <label><input type="checkbox" name="passengers" value="配偶/伴侣" />配偶/伴侣</label>
      <label><input type="checkbox" name="passengers" value="儿童" />儿童</label>
      <label><input type="checkbox" name="passengers" value="老人" />老人</label>
    </div>

    <h2>💰 预算与风险偏好</h2>
    <label>年保费预算（元）：</label>
    <div style="display: flex; gap: 10px;">
        <input type="number" name="minBudget" min="0" placeholder="预算下限" />
        <input type="number" name="maxBudget" min="0" placeholder="预算上限" />
    </div>

    <label>风险承受能力：</label>
    <div class="inline-group">
      <label><input type="radio" name="risk" value="保守型（追求全面保障，不怕保费高）" />保守型（追求全面保障，不怕保费高）</label>
      <label><input type="radio" name="risk" value="平衡型（保障核心风险，兼顾性价比）" checked/>平衡型（保障核心风险，兼顾性价比）</label>
      <label><input type="radio" name="risk" value="经济型（仅需基础保障，保费优先）" />经济型（仅需基础保障，保费优先）</label>
    </div>
    
    <h2>🔍 关注重点（可多选）</h2>
    <div class="inline-group">
      <label><input type="checkbox" name="concern" value="第三方人伤高额赔付保障" />第三方人伤高额赔付保障</label>
      <label><input type="checkbox" name="concern" value="三电系统（电池、电机、电控）核心保障" />三电系统（电池、电机、电控）核心保障</label>
      <label><input type="checkbox" name="concern" value="车内人员安全保障" />车内人员安全保障</label>
      <label><input type="checkbox" name="concern" value="充电桩及充电过程安全保障" />充电桩及充电过程安全保障</label>
      <label><input type="checkbox" name="concern" value="外部电网故障等特殊风险保障" />外部电网故障等特殊风险保障</label>
      <label><input type="checkbox" name="concern" value="车身划痕、车轮单独损坏等小额损失" />车身划痕、车轮单独损坏等小额损失</label>
      <label><input type="checkbox" name="concern" value="增值服务（道路救援、代驾等）" />增值服务（道路救援、代驾等）</label>
      <label><input type="checkbox" name="concern" value="尽可能降低保费成本" />尽可能降低保费成本</label>
    </div>

    <h2>📝 其他补充信息</h2>
    <label>近3年出险次数：</label>
    <input type="number" name="accidentTimes" min="0" />

    <label>其他特殊情况或需求说明：</label>
    <textarea name="specialSituation" rows="3" placeholder="例如：车辆有改装、经常长途自驾、有特定节假日出行需求等"></textarea>
  </form>
</div>

<div style="text-align:center;">
  <button id="btnExcel">导出为Excel</button>
  <button id="btnMarkdown">导出为Markdown</button>
</div>

<script>
// 获取表单数据
function getFormData() {
  const form = document.getElementById('surveyForm');
  const data = {};
  new FormData(form).forEach((value, key) => {
    const el = form.querySelector(`[name="${key}"]`);
    if (el && el.type === 'checkbox') {
        if (!data[key]) {
            data[key] = [];
        }
        data[key].push(value);
    } else {
        data[key] = value;
    }
  });
  return data;
}


// 导出Excel
function exportExcel() {
  const data = getFormData();
  const sheetData = [
    ['项目', '客户选择'],
    ['--- 车辆基本信息 ---', ''],
    ['品牌型号', data.carModel || ''],
    ['车辆类型', data.carType || ''],
    ['购车价格（万元）', data.purchasePrice || ''],
    ['车龄（年）', data.carAge || ''],
    ['年行驶里程（公里）', data.mileage || ''],
    ['--- 充电与电池信息 ---', ''],
    ['是否有固定自用充电桩', data.chargingPile || ''],
    ['充电桩安装位置', data.pileLocation || ''],
    ['是否经常使用公共充电桩', data.publicCharging || ''],
    ['--- 用车环境 ---', ''],
    ['主要行驶区域', data.area || ''],
    ['停车环境', data.parking || ''],
    ['--- 家庭用车情况 ---', ''],
    ['主要驾驶人驾龄（年）', data.driverExperience || ''],
    ['常载人员', (data.passengers || []).join('、')],
    ['--- 预算与风险偏好 ---', ''],
    ['年保费预算（元）', `下限: ${data.minBudget || '未填'}，上限: ${data.maxBudget || '未填'}`],
    ['风险承受能力', data.risk || ''],
    ['--- 关注重点 ---', ''],
    ['关注点', (data.concern || []).join('、')],
    ['--- 其他补充信息 ---', ''],
    ['近3年出险次数', data.accidentTimes || ''],
    ['特殊情况说明', data.specialSituation || ''],
  ];

  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(sheetData);
  
  // 设置列宽
  ws['!cols'] = [{ wch: 25 }, { wch: 60 }];

  XLSX.utils.book_append_sheet(wb, ws, '新能源车险调研数据');
  XLSX.writeFile(wb, '新能源车险调研数据.xlsx');
}

// 导出Markdown
function exportMarkdown() {
  const data = getFormData();
  const fields = [
    ['**车辆基本信息**', ''],
    ['品牌型号', data.carModel || ''],
    ['车辆类型', data.carType || ''],
    ['购车价格（万元）', data.purchasePrice || ''],
    ['车龄（年）', data.carAge || ''],
    ['年行驶里程（公里）', data.mileage || ''],
    ['**充电与电池信息**', ''],
    ['是否有固定自用充电桩', data.chargingPile || ''],
    ['充电桩安装位置', data.pileLocation || ''],
    ['是否经常使用公共充电桩', data.publicCharging || ''],
    ['**用车环境**', ''],
    ['主要行驶区域', data.area || ''],
    ['停车环境', data.parking || ''],
    ['**家庭用车情况**', ''],
    ['主要驾驶人驾龄（年）', data.driverExperience || ''],
    ['常载人员', (data.passengers || []).join('、')],
    ['**预算与风险偏好**', ''],
    ['年保费预算（元）', `下限: ${data.minBudget || '未填'}，上限: ${data.maxBudget || '未填'}`],
    ['风险承受能力', data.risk || ''],
    ['**关注重点**', ''],
    ['关注点', (data.concern || []).join('、')],
    ['**其他补充信息**', ''],
    ['近3年出险次数', data.accidentTimes || ''],
    ['特殊情况说明', data.specialSituation || '']
  ];

  let md = `# ⚡ 新能源汽车保险配置需求调研表\n\n`;
  md += `| 字段 | 内容 |\n| :--- | :--- |\n`;
  fields.forEach(([k, v]) => {
    v = (v + '').replace(/\|/g, '\\|').replace(/\n/g, '<br>');
    md += `| ${k} | ${v || '未填写'} |\n`;
  });

  const blob = new Blob([md], {type: 'text/markdown;charset=utf-8'});
  saveAs(blob, '新能源车险调研数据.md');
}


// 绑定按钮事件
document.getElementById('btnExcel').onclick = (e) => {
    e.preventDefault();
    exportExcel();
};
document.getElementById('btnMarkdown').onclick = (e) => {
    e.preventDefault();
    exportMarkdown();
};
</script>

</body>
</html>